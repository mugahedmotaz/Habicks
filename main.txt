<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØªØ¨Ø¹ Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
    <style>
        body { font-family: 'Cairo', sans-serif; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="container max-w-lg mx-auto bg-white rounded-xl shadow-md p-8 mt-10">
        <h1 class="text-3xl font-bold text-center text-green-800 mb-8">ØªØªØ¨Ø¹ Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h1>
        <form id="add-habit-form" class="flex flex-col md:flex-row gap-3 mb-8">
            <input type="text" id="habit-name" placeholder="Ù…Ø§Ø°Ø§ Ø£Ù†Ø¬Ø²Øª Ø§Ù„ÙŠÙˆÙ…ØŸ" required class="flex-1 px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-400" />
            <select id="habit-type" class="px-3 py-2 rounded-md border border-gray-300 focus:outline-none">
                <option value="Ø±ÙŠØ§Ø¶Ø©">ğŸƒâ€â™‚ï¸ Ø±ÙŠØ§Ø¶Ø©</option>
                <option value="Ù‚Ø±Ø§Ø¡Ø©">ğŸ“š Ù‚Ø±Ø§Ø¡Ø©</option>
                <option value="Ø´Ø±Ø¨ Ø§Ù„Ù…Ø§Ø¡">ğŸ’§ Ø´Ø±Ø¨ Ø§Ù„Ù…Ø§Ø¡</option>
                <option value="Ù†ÙˆÙ… Ù…Ø¨ÙƒØ±">ğŸ›Œ Ù†ÙˆÙ… Ù…Ø¨ÙƒØ±</option>
                <option value="ØªØ£Ù…Ù„">ğŸ§˜â€â™‚ï¸ ØªØ£Ù…Ù„</option>
                <option value="Ø£Ø®Ø±Ù‰">âœ¨ Ø£Ø®Ø±Ù‰</option>
            </select>
            <button type="submit" class="bg-green-700 hover:bg-green-800 text-white font-bold px-4 py-2 rounded-md">Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</button>
        </form>
        <div id="habit-list" class="space-y-4">
            <!-- Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ù‡Ù†Ø§ -->
        </div>
    </div>
    <!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script>
// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù…Ù† Firebase (Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ù‚ÙŠÙ… Ø¨Ù…Ø§ ÙŠØ¸Ù‡Ø± Ù„Ùƒ ÙÙŠ Firebase Console)
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT_ID.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ®Ø²ÙŠÙ†
async function loadHabits() {
    const snapshot = await db.collection('habits').orderBy('id', 'desc').get();
    return snapshot.docs.map(doc => doc.data());
}
async function saveHabits(habits) {
    // Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø«Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ø­Ù„ Ø¨Ø³ÙŠØ·)
    const batch = db.batch();
    const ref = db.collection('habits');
    const old = await ref.get();
    old.forEach(doc => batch.delete(doc.ref));
    habits.forEach(h => batch.set(ref.doc(h.id+''), h));
    await batch.commit();
}
function getPeriodStart(period) {
    const now = new Date();
    if (period === 'day') {
        return new Date(now.getFullYear(), now.getMonth(), now.getDate());
    } else if (period === 'week') {
        const day = now.getDay();
        const diff = now.getDate() - day + (day === 0 ? -6 : 1); // Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø§Ø«Ù†ÙŠÙ†
        return new Date(now.getFullYear(), now.getMonth(), diff);
    } else if (period === 'month') {
        return new Date(now.getFullYear(), now.getMonth(), 1);
    }
}
function isInPeriod(dateStr, period) {
    const d = new Date(dateStr);
    const start = getPeriodStart(period);
    const now = new Date();
    if (period === 'day') {
        return d.toDateString() === now.toDateString();
    } else if (period === 'week' || period === 'month') {
        return d >= start && d <= now;
    }
}
function countConsecutiveDays(habits, type) {
    // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø­Ø¯Ø«
    const filtered = habits.filter(h => h.type === type).sort((a, b) => new Date(b.dateObj) - new Date(a.dateObj));
    let count = 0;
    let prev = null;
    for (let h of filtered) {
        if (!prev) {
            count = 1;
        } else {
            const diff = (prev - h.dateObj) / (1000 * 60 * 60 * 24);
            if (diff === 1) {
                count++;
            } else {
                break;
            }
        }
        prev = h.dateObj;
    }
    return count;
}
function renderGoldenHabits(habits) {
    // Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø§Ù„ØªÙŠ ØªÙ… Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø¹Ù„ÙŠÙ‡Ø§ 21 ÙŠÙˆÙ… Ù…ØªØªØ§Ù„ÙŠ
    const types = [...new Set(habits.map(h => h.type))];
    let html = '';
    types.forEach(type => {
        const filtered = habits.filter(h => h.type === type).map(h => ({...h, dateObj: new Date(h.date)}));
        const days = countConsecutiveDays(filtered, type);
        if (days >= 21) {
            html += `<div class="bg-yellow-200 text-yellow-900 rounded p-3 mb-2 flex items-center gap-2"><span>${habitIcons[type] || habitIcons['Ø£Ø®Ø±Ù‰']}</span> <span>Ø¹Ø§Ø¯Ø© Ø°Ù‡Ø¨ÙŠØ©: ${type} (21 ÙŠÙˆÙ… Ù…ØªØªØ§Ù„ÙŠ)</span></div>`;
        }
    });
    document.getElementById('golden-habits').innerHTML = html;
}
function renderHabits(habits, period = 'day') {
    const list = document.getElementById('habit-list');
    const filtered = habits.filter(h => isInPeriod(h.dateObj, period));
    if (!filtered.length) {
        list.innerHTML = '<div class="text-center text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©</div>';
        return;
    }
    let html = `<table class="w-full text-center border rounded-lg overflow-hidden">
        <thead class="bg-gray-100">
            <tr>
                <th class="py-2">#</th>
                <th class="py-2">Ø§Ù„Ù†ÙˆØ¹</th>
                <th class="py-2">Ø§Ù„ÙˆØµÙ</th>
                <th class="py-2">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
            </tr>
        </thead>
        <tbody>`;
    filtered.forEach((habit, i) => {
        html += `<tr class="border-b">
            <td class="py-2">${i + 1}</td>
            <td class="py-2 text-xl">${habitIcons[habit.type] || habitIcons['Ø£Ø®Ø±Ù‰']}</td>
            <td class="py-2">${habit.name}</td>
            <td class="py-2">${habit.date}</td>
        </tr>`;
    });
    html += '</tbody></table>';
    list.innerHTML = html;
}
function render21Table(habits) {
    // Ø¬Ø¯ÙˆÙ„ Ù…ØªØ§Ø¨Ø¹Ø© Ø¢Ø®Ø± 21 ÙŠÙˆÙ…Ù‹Ø§ Ù„ÙƒÙ„ Ø¹Ø§Ø¯Ø© Ø¨Ø´ÙƒÙ„ Ù…Ù†ÙØµÙ„ Ù…Ø¹ ØªØ­ÙÙŠØ² Ø¨ØµØ±ÙŠ
    const types = getUniqueHabits(habits);
    let html = '';
    types.forEach(type => {
        const filtered = habits.filter(h => h.type === type).sort((a, b) => new Date(a.dateObj) - new Date(b.dateObj));
        // Ø¨Ù†Ø§Ø¡ Ù…ØµÙÙˆÙØ© ØªÙˆØ§Ø±ÙŠØ® Ø¢Ø®Ø± 21 ÙŠÙˆÙ…
        const days = [];
        const today = new Date();
        for (let i = 20; i >= 0; i--) {
            const d = new Date(today.getFullYear(), today.getMonth(), today.getDate() - i);
            days.push(d);
        }
        // Ø¨Ù†Ø§Ø¡ ØµÙ Ø¯ÙˆØ§Ø¦Ø± Ù…Ø¹ tooltip
        let circles = '';
        days.forEach((d, idx) => {
            const found = filtered.find(h => {
                const hd = h.dateObj;
                return hd.getFullYear() === d.getFullYear() && hd.getMonth() === d.getMonth() && hd.getDate() === d.getDate();
            });
            circles += `<span title="${d.toLocaleDateString('ar-EG', { weekday: 'long', day: 'numeric', month: 'short' })}${found ? ' - âœ”ï¸ - ' + found.time : ''}" class="inline-block w-5 h-5 rounded-full mx-0.5 border border-gray-300 ${found ? 'bg-green-500 border-green-600' : 'bg-gray-200'}"></span>`;
        });
        const count = filtered.length;
        const streak = filtered.length ? getHabitStreak(habits, type) : 0;
        const golden = streak >= 21 ? '<span class="ml-2 text-yellow-500"><i class="fa-solid fa-crown"></i> Ø°Ù‡Ø¨ÙŠØ©!</span>' : '';
        html += `<div class="mb-6 p-4 rounded-lg shadow bg-white">
            <div class="flex items-center gap-2 mb-2">
                <span class="text-2xl">${habitIcons[type] || habitIcons['Ø£Ø®Ø±Ù‰']}</span>
                <span class="font-bold text-lg">${type}</span>
                <span class="ml-2 text-green-700">Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©: ${filtered.length ? streak : 0} ÙŠÙˆÙ…</span>
                <span class="ml-2 text-blue-700">Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª: ${count}</span>
                ${golden}
            </div>
            <div class="flex flex-wrap items-center">${circles}</div>
        </div>`;
    });
    document.getElementById('habit-21-table').innerHTML = html;
}
function getUniqueHabits(habits) {
    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¹Ø§Ø¯Ø§Øª
    return [...new Set(habits.map(h => h.type))];
}
function getHabitStreak(habits, type) {
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© (streak) Ù„Ø¹Ø§Ø¯Ø© Ù…Ø¹ÙŠÙ†Ø©
    const filtered = habits.filter(h => h.type === type).sort((a, b) => new Date(a.dateObj) - new Date(b.dateObj));
    let streak = 0;
    let prev = null;
    for (let h of filtered) {
        if (!prev) {
            streak = 1;
        } else {
            const diff = (h.dateObj - prev) / (1000 * 60 * 60 * 24);
            if (diff === 1) {
                streak++;
            } else if (diff > 1) {
                streak = 1;
            }
        }
        prev = h.dateObj;
    }
    return streak;
}
function renderHabitCalendars(habits) {
    // ØªÙ‚ÙˆÙŠÙ… Ù…ØµØºØ± Ù„ÙƒÙ„ Ø¹Ø§Ø¯Ø©
    const container = document.getElementById('habit-list');
    const types = getUniqueHabits(habits);
    if (!types.length) {
        container.innerHTML = '<div class="text-center text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø§Ø¯Ø§Øª Ø¨Ø¹Ø¯</div>';
        return;
    }
    let html = '';
    types.forEach(type => {
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙƒÙ„ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ù†Ø¬Ø²Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø§Ø¯Ø©
        const filtered = habits.filter(h => h.type === type).sort((a, b) => new Date(a.dateObj) - new Date(b.dateObj));
        // Ø¨Ù†Ø§Ø¡ Ù…ØµÙÙˆÙØ© ØªÙˆØ§Ø±ÙŠØ® Ø¢Ø®Ø± 30 ÙŠÙˆÙ…
        const days = [];
        const today = new Date();
        for (let i = 29; i >= 0; i--) {
            const d = new Date(today.getFullYear(), today.getMonth(), today.getDate() - i);
            days.push(d);
        }
        // Ø¨Ù†Ø§Ø¡ ØµÙ Ø¯ÙˆØ§Ø¦Ø±
        let circles = '';
        days.forEach(d => {
            const found = filtered.find(h => {
                const hd = h.dateObj;
                return hd.getFullYear() === d.getFullYear() && hd.getMonth() === d.getMonth() && hd.getDate() === d.getDate();
            });
            circles += `<span class="inline-block w-4 h-4 rounded-full mx-0.5 ${found ? 'bg-green-500' : 'bg-gray-300'}"></span>`;
        });
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©
        const streak = getHabitStreak(habits, type);
        // Ø´Ø§Ø±Ø© Ø°Ù‡Ø¨ÙŠØ©
        const golden = streak >= 21 ? '<span class="ml-2 text-yellow-500"><i class="fa-solid fa-crown"></i> Ø°Ù‡Ø¨ÙŠØ©!</span>' : '';
        html += `<div class="mb-6 p-4 rounded-lg shadow bg-white">
            <div class="flex items-center gap-2 mb-2">
                <span class="text-2xl">${habitIcons[type] || habitIcons['Ø£Ø®Ø±Ù‰']}</span>
                <span class="font-bold text-lg">${type}</span>
                <span class="ml-2 text-green-700">Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©: ${streak} ÙŠÙˆÙ…</span>
                ${golden}
            </div>
            <div class="flex flex-wrap items-center">${circles}</div>
        </div>`;
    });
    container.innerHTML = html;
}
// Ø¯Ù…Ø¬ Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… ÙˆØ¬Ø¯ÙˆÙ„ 21 ÙŠÙˆÙ… ÙÙŠ Ø¯Ø§Ù„Ø© ÙˆØ§Ø­Ø¯Ø©ØŒ Ù…Ø¹ Ø²Ø± Ø­Ø°ÙØŒ ÙˆØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ø°Ù‡Ø¨ØŒ ÙˆØ¹Ø¯Ø§Ø¯ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
let lastGolden = {};
function renderHabitsDashboard(habits) {
    const container = document.getElementById('habit-list');
    // Ø§Ø³ØªØ¨Ø¹Ø¯ Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø§Ù„ØªÙŠ Ù„Ù‡Ø§ ÙˆØµÙ
    const filteredHabits = habits.filter(h => !h.desc || h.desc.length === 0);
    const types = getUniqueHabits(filteredHabits);
    if (!types.length) {
        container.innerHTML = '<div class="text-center text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø§Ø¯Ø§Øª Ø¨Ø¹Ø¯</div>';
        return;
    }
    let total = filteredHabits.length;
    let html = `<div class="mb-4 text-center font-bold text-green-700">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª: ${total}</div>`;
    types.forEach(type => {
        const filtered = filteredHabits.filter(h => h.type === type).sort((a, b) => new Date(a.dateObj) - new Date(b.dateObj));
        const days = [];
        const today = new Date();
        for (let i = 20; i >= 0; i--) {
            const d = new Date(today.getFullYear(), today.getMonth(), today.getDate() - i);
            days.push(d);
        }
        let circles = '';
        days.forEach((d, idx) => {
            const found = filtered.find(h => {
                const hd = h.dateObj;
                return hd.getFullYear() === d.getFullYear() && hd.getMonth() === d.getMonth() && hd.getDate() === d.getDate();
            });
            circles += `<span title="${d.toLocaleDateString('ar-EG', { weekday: 'long', day: 'numeric', month: 'short' })}${found ? ' - âœ”ï¸ - ' + found.time : ''}" class="inline-block w-5 h-5 rounded-full mx-0.5 border border-gray-300 ${found ? 'bg-green-500 border-green-600' : 'bg-gray-200'}"></span>`;
        });
        const count = filtered.length;
        const streak = filtered.length ? getHabitStreak(filteredHabits, type) : 0;
        const golden = streak >= 21 ? '<span class="ml-2 text-yellow-500"><i class="fa-solid fa-crown"></i> Ø°Ù‡Ø¨ÙŠØ©!</span>' : '';
        if (streak >= 21 && lastGolden[type] !== streak) {
            alert(`Ù…Ø¨Ø±ÙˆÙƒ! Ø­Ù‚Ù‚Øª Ø¹Ø§Ø¯Ø© Ø°Ù‡Ø¨ÙŠØ© (${type}) Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© ${streak} ÙŠÙˆÙ…`);
            lastGolden[type] = streak;
        }
        html += `<div class="mb-6 p-4 rounded-lg shadow bg-white">
            <div class="flex items-center gap-2 mb-2">
                <span class="text-2xl">${habitIcons[type] || habitIcons['Ø£Ø®Ø±Ù‰']}</span>
                <span class="font-bold text-lg">${type}</span>
                <span class="ml-2 text-green-700">Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©: ${filtered.length ? streak : 0} ÙŠÙˆÙ…</span>
                <span class="ml-2 text-blue-700">Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª: ${count}</span>
                ${golden}
                <button class="delete-habit-btn ml-auto bg-red-500 hover:bg-red-700 text-white rounded px-2 py-1 text-xs" data-type="${type}"><i class="fa fa-trash"></i> Ø­Ø°Ù</button>
            </div>
            <div class="flex flex-wrap items-center">${circles}</div>
        </div>`;
    });
    container.innerHTML = html;
    document.querySelectorAll('.delete-habit-btn').forEach(btn => {
        btn.onclick = function() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø§Ø¯Ø©ØŸ')) {
                const type = this.dataset.type;
                const newHabits = habits.filter(h => h.type !== type);
                saveHabits(newHabits);
                renderAll();
            }
        };
    });
}
document.getElementById('add-habit-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    const name = document.getElementById('habit-name').value.trim();
    const desc = document.getElementById('habit-desc').value.trim();
    const type = document.getElementById('habit-type').value;
    if (!name) return;
    const habits = await loadHabits();
    const now = new Date();
    habits.unshift({
        id: Date.now(),
        name,
        desc,
        type,
        date: now.toLocaleDateString('ar-EG', { year: 'numeric', month: 'long', day: 'numeric' }),
        dateObj: new Date(now.getFullYear(), now.getMonth(), now.getDate()),
        time: now.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' })
    });
    await saveHabits(habits);
    this.reset();
    renderAll();
});
let currentPeriod = 'day';
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        currentPeriod = this.dataset.period;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('bg-green-200', 'text-green-800'));
        this.classList.add('bg-green-200', 'text-green-800');
        const habits = loadHabits();
        renderHabits(habits, currentPeriod);
        render21Table(habits);
    });
});
// Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
function renderAll() {
    const habits = loadHabits().map(h => ({...h, dateObj: h.dateObj ? new Date(h.dateObj) : new Date(new Date(h.date).getFullYear(), new Date(h.date).getMonth(), new Date(h.date).getDate())}));
    renderHabitsDashboard(habits);
    renderGoldenHabits(habits);
}
document.addEventListener('DOMContentLoaded', async function() {
    const habits = await loadHabits();
    renderHabitsDashboard(habits);
    renderGoldenHabits(habits);
    render21Table(habits);
    // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„Ø­Ø°Ù Ù„ÙƒÙ„ Ø¹Ø§Ø¯Ø©
    document.querySelectorAll('.delete-habit-btn').forEach(btn => {
        btn.onclick = function() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø§Ø¯Ø©ØŸ')) {
                const type = this.dataset.type;
                const newHabits = habits.filter(h => h.type !== type);
                saveHabits(newHabits);
                renderAll();
            }
        };
    });
});
// Ø¬Ø¯ÙˆÙ„ Ø®Ø§Øµ Ù„Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø°Ø§Øª Ø§Ù„ÙˆØµÙ ÙÙ‚Ø·
function renderSearchedHabitsTable(habits) {
    const container = document.getElementById('habit-list');
    if (!habits.length) {
        container.innerHTML = '<div class="text-center text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«</div>';
        return;
    }
    let html = `<div class="mb-4 text-center font-bold text-blue-700">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙØµÙ„Ø©</div>`;
    habits.forEach((habit, i) => {
        html += `<div class="w-full max-w-2xl mx-auto mb-8 p-6 rounded-2xl shadow-2xl bg-gradient-to-l from-blue-50 to-white flex flex-col gap-3 md:flex-row md:items-center md:gap-8 transition hover:shadow-blue-200 border border-blue-100">
            <div class="flex items-center gap-4 mb-2 md:mb-0">
                <span class="text-3xl">${habitIcons[habit.type] || habitIcons['Ø£Ø®Ø±Ù‰']}</span>
                <span class="font-bold text-xl">${habit.name}</span>
                <span class="text-gray-500 text-base">(${habit.type})</span>
            </div>
            <div class="flex-1 text-right text-gray-700 text-base">${habit.desc || '-'}</div>
            <div class="flex flex-col md:items-end gap-2 text-sm text-gray-600 min-w-[120px]">
                <div><i class="fa-regular fa-calendar"></i> ${habit.date}</div>
                <div><i class="fa-regular fa-clock"></i> ${habit.time || '-'}</div>
            </div>
        </div>`;
    });
    container.innerHTML = html;
}
document.getElementById('search-btn').onclick = async function() {
    const dateVal = document.getElementById('search-date').value;
    const query = document.getElementById('search-query').value.trim();
    let habits = await loadHabits();
    // ÙÙ‚Ø· Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø§Ù„ØªÙŠ Ù„Ù‡Ø§ ÙˆØµÙ
    let describedHabits = habits.filter(h => h.desc && h.desc.length > 0);
    if (dateVal) {
        const d = new Date(dateVal);
        describedHabits = describedHabits.filter(h => h.dateObj.getFullYear() === d.getFullYear() && h.dateObj.getMonth() === d.getMonth() && h.dateObj.getDate() === d.getDate());
    }
    if (query) {
        describedHabits = describedHabits.filter(h => h.name.includes(query) || (h.desc && h.desc.includes(query)) || h.type.includes(query));
    }
    renderSearchedHabitsTable(describedHabits);
    renderGoldenHabits([]); // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© ÙÙŠ Ø§Ù„Ø¨Ø­Ø«
};
document.getElementById('reset-search').onclick = function() {
    document.getElementById('search-date').value = '';
    document.getElementById('search-query').value = '';
    renderAll();
};
</script>
</body>
</html>